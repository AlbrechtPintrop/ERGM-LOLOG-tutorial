# 关于Exponential Random Graph Model在其他社会学或经济学角度的应用

 [多元文化志愿服务项目中的社交网络结构研究.pdf](/Users/ww/Desktop/组会/组会（找文章）/ermg模型/多元文化志愿服务项目中的社交网络结构研究.pdf) 

## ***多元文化志愿服务项目中的社交网络结构研究***

## 研究背景与问题

在 **社会网络理论（Social Network Theory, SNT）** 中，**同性恋性（homophily）** 指的是人们更倾向于与和自己相似的人建立社交联系，例如 **相同的性别、种族、国籍、教育背景等**。  

现有研究发现，移民和难民群体通常形成紧密的同质性社交网络（如种族聚居区），但也有研究表明，他们可能建立跨族裔的社交联系，以获取经济、住房等资源。然而，关于 **老年移民在多元文化志愿服务项目中的社交模式**，研究仍然较少。  

### 核心研究问题：
1. **志愿者之间的友谊是否是互惠的（reciprocity）？**
2. **志愿者是否会倾向于朋友的朋友（transitivity，即三角关系）？**
3. **同性恋性（homophily）是否影响友谊形成？影响因素包括：**
   - 年龄
   - 性别
   - 种族
   - 国籍
   - 教育背景
   - 招募地点

## 研究方法

本研究采用 **指数族随机图模型（Exponential Random Graph Model, ERGM）** 进行社交网络分析，并通过问卷调查收集数据：

- **研究对象**：美国中西部某地 41 名 SCP 志愿者（包括俄语、柬埔寨语、索马里语、尼泊尔语和英语使用者）。
- **数据收集方式**：2021 年 10 月，在 SCP 志愿者培训会议中，研究者通过问卷调查，让参与者 **提名 5 名朋友**，并记录他们的社交互动频率。
- **主要变量**：
  - **自变量**：年龄、性别、国籍、教育水平、招募地点等。
  - **因变量**：社交联系的形成（是否有友谊关系）。
  - **网络特征**：
    - **互惠性（reciprocity）**：A 认为 B 是朋友，B 是否也认为 A 是朋友？
    - **传递性（transitivity）**：如果 A 和 B 是朋友，B 和 C 是朋友，那么 A 和 C 是否也成为朋友？
    - **同性恋性（homophily）**：是否更倾向于与相同特征（如同国籍、同性别、同教育水平）的人交朋友。

## 数学模型（ERGM 公式）

ERGM 用于分析社交网络的结构，计算不同因素对 **关系形成的影响**。其概率分布如下：

$$
P(Y = y) = \frac{\exp(\theta^T g(y))}{c(\theta)}
$$

其中：
- $Y$ 代表社交网络的关系矩阵（即谁和谁是朋友）。
- $g(y)$ 是网络统计特征，如 **同性恋性、互惠性、三角关系** 等。
- $\theta$ 是参数，衡量每个网络特征对友谊形成的影响。
- $c(\theta)$ 是归一化常数，确保概率总和为 1。

**关键统计量**：
- **互惠性（reciprocity）**：如果 A 认定 B 是朋友，B 也认定 A 是朋友的概率。
- **传递性（transitivity）**：如果 A 和 B 是朋友，B 和 C 是朋友，A 和 C 是否也会成为朋友？
- **同性恋性（homophily）**：人们是否更倾向于与相同背景（如国籍、性别、教育水平等）的人交朋友？

## 研究结果

1. 同性恋性显著存在

- 志愿者更倾向于和 **相同国籍、性别、教育背景、同一招募地点** 的人建立友谊：
  - **性别同性恋（β = 3.27，p < 0.001）**：男性更可能与男性成为朋友，女性更可能与女性交往。
  - **国籍同性恋（β = 2.89，p < 0.001）**：志愿者更可能与相同国家背景的人交朋友。
  - **教育水平同性恋（β = 0.71，p < 0.001）**：具有相似教育背景的人更可能建立联系。
  - **招募地点同性恋（β = 2.77，p < 0.001）**：从同一组织招募的志愿者更倾向于互相联系。

2. 互惠性不显著（$β = -0.1，p = 0.74$）

- 友谊关系 **不是双向的**，即 A 认为 B 是朋友，但 B 不一定认为 A 是朋友。

3. 传递性显著为负（$β = -1.01，p < 0.001$）

- **朋友的朋友未必成为朋友**，与典型的社交网络不同。
- 可能的原因是 **SCP 的组织结构使社交关系更依赖个体选择，而非社交网络效应**。

## 研究贡献

### 1. 揭示多元文化志愿者的社交模式
- 研究发现，在多元文化志愿服务项目中，社交网络仍然 **以同性恋性为主**，即志愿者更倾向于和相似背景的人建立联系，而不是形成跨文化的网络。
- 但这并不一定意味着排外，而可能是语言、文化认同等因素导致的自然选择。

### 2. 挑战了社交网络中的“朋友的朋友”理论
- 研究发现，**志愿者更像“工作朋友”，而非深度社交朋友**。
- 这对多元文化项目的设计有重要意义，比如可以通过 **混合招募和团队活动** 促进跨文化社交。

## 政策与实践建议

### 1. **减少国籍和语言障碍**
- 在招募时尽量 **混合不同背景的志愿者**，减少国籍聚集效应。
- 提供 **翻译服务**，帮助不同语言背景的志愿者交流。

### 2. **促进跨文化交流**
- 设计 **混合团队任务**，让不同背景的志愿者合作完成项目，而不是单独工作。
- 组织 **社交活动**，鼓励不同国家的志愿者建立更深的联系。

### 3. **关注志愿者的社会支持**
- 研究显示，志愿者的友谊较浅，因此应提供 **更多社交支持**，帮助他们建立更稳固的关系，提高长期参与度。

## 总结

本研究通过 **指数族随机图模型（ERGM）** 分析了 **多元文化老年志愿者的社交网络**，发现：
- **社交关系主要受同性恋性影响**（国籍、性别、教育背景、招募地点）。
- **友谊关系并非双向**（互惠性不显著）。
- **“朋友的朋友”效应较弱**（传递性为负），意味着志愿者的关系更像“工作友谊”而非深度社交。

**政策建议**：通过 **混合招募、翻译服务、社交活动** 等方式，促进跨文化友谊，增强多元文化志愿服务的社交价值。  

 [中国区域交通碳排放的社交网络分析：基于模式分析和指数族随机图模型.pdf](/Users/ww/Desktop/组会/组会（找文章）/ermg模型/中国区域交通碳排放的社交网络分析：基于模式分析和指数族随机图模型.pdf) 

## ***中国区域交通碳排放的社交网络分析：基于模式分析和指数族随机图模型***

## **研究背景与问题**
### **背景**
- 交通相关的碳排放对空气质量和气候变化具有重大影响，理解区域间碳排放的动态至关重要。
- 现有研究对碳排放的研究较多，但对 **中国省际交通碳排放的关联网络** 缺乏系统分析。
- 该研究基于 **2007-2021年** 中国各省的数据，分析省际交通碳排放的网络结构，识别关键模式，并利用 **指数族随机图模型（ERGM）** 研究网络的形成机制。

### **核心问题**
1. **区域间的碳排放流动是如何形成的？**
2. **哪些省份在碳排放网络中处于核心地位？**
3. **区域间的碳排放是否具有某种结构模式？**
4. **政府干预、城镇化率等外部因素如何影响碳排放网络？**

---

## **研究方法**
### **数据**
- **时间范围**：2007-2021年
- **研究对象**：中国 **30个省份**（不包括西藏、澳门、台湾和香港）
- **数据来源**：
  - **中国碳核算数据库（CEADS）**
  - **中国省级统计年鉴**
  
### **方法**
1. **社交网络分析（Social Network Analysis, SNA）**  
   - 构建 **省际交通碳排放网络**，分析网络基本结构特征，并将其分为 **四个板块**。
  
2. **模式分析（Motif Analysis）**  
   - 识别 **微观关联模式**，分析网络内部的结构模式。

3. **指数族随机图模型（Exponential Random Graph Model, ERGM）**  
   - 研究**省际碳排放网络的形成机制**，考察网络的内生结构因素和外部环境变量。

---

## **研究结果**
### **1. 省际交通碳排放网络的结构**
- **东部省份（如上海、北京）处于碳排放网络的中心**，主要接收来自其他省份的碳排放。
- **西部地区主要向其他省份输送碳排放**，并逐渐向中心靠拢。
- 省际碳排放网络可分为**四大板块**：
  1. **净受益板块（Net Beneficiary Plate）**：主要接收碳排放，如北京、江苏、浙江。
  2. **净溢出板块（Net Overflow Plate）**：主要向外输出碳排放，如新疆、甘肃、青海。
  3. **双向溢出板块（Bidirectional Spillover Plate）**：既接收也输出碳排放，如辽宁、吉林。
  4. **中介板块（Broker Plate）**：充当碳排放的中介，如广东、福建。

### **2. 微观结构模式（Motif Analysis）**
- **主要影响网络的模式为双向关联（bidirectional motifs）**，但部分结构模式**阻碍了跨区域合作和碳减排**。
- 影响较大的模式：
  - **GCX模式**：通过中介省份间接建立碳排放关联。
  - **F8X模式**：强调网络的桥梁作用，使碳排放关系更加复杂。

### **3. 省际碳排放网络的驱动因素（ERGM 结果）**
- **网络结构变量**
  - **互惠性（Mutuality）显著**（β = 3.507，p < 0.001），表明碳排放关系**主要是双向的**。
  - **三角关系（Cyclic Triple）为负**（β = -1.129，p < 0.001），说明“朋友的朋友”未必是朋友，网络结构较松散。
  - **几何加权边共享伙伴（Gwesp）显著正相关**（β = 0.942，p < 0.001），表明网络具有一定的聚集性。

- **外部环境变量**
  - **政府干预（Government Intervention）**：政府财政支出增加，会促进碳排放网络的形成（β = 0.00074，p < 0.001）。
  - **对外开放程度（Openness）**：对外贸易的增长会增强碳排放网络的联系（β = 0.00041，p < 0.001）。
  - **城镇化率（Urbanization Rate）**：
    - **碳排放接收方的城镇化率越高，碳排放联系越弱**（β = -6.391，p < 0.001）。
    - **不同城镇化率的省份之间，碳排放联系更强**（β = 7.438，p < 0.001）。

---

## **政策建议**
### **1. 促进区域间低碳合作**
- 由于**东部省份主要接收碳排放**，应加强**跨区域合作**，推动碳交易机制，鼓励**东部省份资助西部省份减排**。

### **2. 加强交通基础设施建设**
- 研究表明，**城镇化率较高的地区碳排放联系较弱**，政府应在这些地区**优化交通运输结构，降低碳排放**。

### **3. 提高能源效率**
- 由于**双向溢出板块在碳排放网络中起到关键作用**，建议这些省份优化产业结构，提高能源使用效率。

### **4. 调整政府财政支出**
- **政府对交通基础设施的投资对碳排放网络影响显著**，应制定合理的财政支出结构，**在碳排放较高的省份加强低碳技术支持**。

---

## **总结**
本研究通过 **社交网络分析（SNA）**、**模式分析（Motif Analysis）** 和 **指数族随机图模型（ERGM）**，探讨了 **中国省际交通碳排放网络的结构、影响因素及政策建议**。主要结论如下：
1. **东部省份处于碳排放网络的中心**，西部地区主要向东部输送碳排放。
2. **碳排放网络具有明显的板块特征**，可分为 **净受益、净溢出、双向溢出和中介板块**。
3. **碳排放的主要驱动因素包括政府干预、对外开放程度和城镇化率**，其中 **政府财政支出对网络形成影响显著**。
4. **政策建议**：加强跨区域合作、优化交通结构、提高能源效率、调整财政支出。

本研究为 **中国跨区域协同减排和低碳交通发展** 提供了理论基础，并对未来 **全国交通碳排放政策的制定** 具有重要指导意义。

 [指数族随机图模型在计数值网络中的参数估计：一项比较模拟研究.pdf](/Users/ww/Desktop/组会/组会（找文章）/ermg模型/指数族随机图模型在计数值网络中的参数估计：一项比较模拟研究.pdf) 

## ***指数族随机图模型在计数值网络中的参数估计：一项比较模拟研究***

## **研究背景与问题**
### **背景**
- **指数族随机图模型（ERGMs）** 是社交网络分析中的重要建模框架，被广泛应用于各种关系类型的研究。
- **计数值网络（count-valued networks）** 是其中一类特殊的网络，边的值为非负整数，例如移民流动、贸易流量、人与人之间的互动频率等。
- 现有研究在 **二元网络** 方面取得了较大发展，但 **计数值 ERGMs 的参数估计** 仍然面临计算挑战。

### **核心问题**
1. **现有 ERGM 参数估计方法在计数值网络中的性能如何？**
2. **网络规模、边值方差对估计精度和计算时间的影响？**
3. **不同估计方法的计算成本和精度如何平衡？**
4. **是否有更高效的 ERGM 估计方法，特别是适用于大规模数据集？**

---

## **研究方法**
### **数据**
- **数据来源**：研究使用美国两个州的 **县际移民流动网络** 进行模拟研究。
- **网络规模**：
  - **小规模网络**（33 个节点）
  - **大规模网络**（100 个节点）
- **边的取值**：
  - **小方差情况**：边值范围 0-9，标准差约 2
  - **大方差情况**：边值范围 0-3862，标准差 201

### **方法**
1. **对比三种 ERGM 估计方法**：
   - **对比散度（Contrastive Divergence, CD）**
   - **最大伪似然估计（Maximum Pseudo-Likelihood Estimation, MPLE）**
   - **蒙特卡洛最大似然估计（Monte Carlo Maximum Likelihood Estimation, MCMLE）**

2. **指数族随机图模型（ERGM）**
   - 设定 ERGM 统计量，包括 **边总和（Sum）、非零边数（Nonzero）、人口、地理距离、互惠性（Mutual）、流量（Flow）** 等变量。
   - 通过模拟网络数据，测试不同方法的 **估计精度、计算速度和稳定性**。

---

## **数学模型（ERGMs 公式）**
计数值 ERGM 的概率分布如下：

$$
P(Y = y | \theta, X) =
\frac{h(y) \exp(\theta^T g(y, X))}{\sum_{y' \in Y} h(y') \exp(\theta^T g(y', X))}
$$

其中：
- $Y$表示计数值网络的关系矩阵。
- $g(y, X)$是网络的统计特征，例如 **互惠性、传递性** 等。
- $\theta$ 是参数，衡量各网络特征对关系形成的影响。
- $h(y)$是基准测度（Poisson 分布），控制边值的基本分布。

**关键统计量**：

- **互惠性（Mutuality）**：如果 A 向 B 发送移民流，B 是否也向 A 发送？
- **流量（Flow）**：某个节点的迁入和迁出流量的最小值。

---

## **研究结果**
### **1. 估计方法的对比**
- **小方差网络**：
  - **所有方法的点估计误差较小**，CD 方法估计的标准误较大，导致置信区间过于保守。
  - MPLE **在依赖性参数上的标准误偏小**，但总体估计质量较高。
  - **MCMLE 提供最优的估计质量，但计算时间较长**。

- **大方差网络**：
  - **CD 方法的估计偏差较大，且可能导致 MCMLE 训练失败**。
  - **MPLE 在大方差网络上的估计质量优于 MCMLE，且计算速度快一个数量级**。
  - **MCMLE 计算成本极高，适用于小规模数据，但大规模网络计算代价太高**。

### **2. 计算效率**
- **计算时间对比（小网络 vs. 大网络）**：
  - **CD 计算最快**，但估计精度较差。
  - **MPLE 计算速度快，且可以通过多线程并行计算进一步提升效率**。
  - **MCMLE 计算时间随网络规模指数增长，在大网络上耗时极长**。

- **MPLE 计算时间优化策略**：
  - **子采样（subsampling）**：对网络中一部分边进行计算，提高计算效率。
  - **并行计算（multi-core processing）**：利用多核 CPU 并行计算 MPLE，降低计算时间。

### **3. 估计稳定性**
- **CD 方法在大方差数据上不稳定，可能导致估计失败**。
- **MPLE 估计稳定性强，且计算时间远小于 MCMLE**。
- **MCMLE 依赖于良好的初始化值，否则可能无法收敛**。

---

## **政策与实践建议**
### **1. 选择合适的 ERGM 估计方法**
- **小规模、小方差网络**：**MCMLE 是最佳选择**，提供高质量估计，但计算成本较高。
- **大规模、大方差网络**：
  - **CD 方法不可靠，不建议使用**。
  - **MPLE 是最佳方法，估计质量高，计算成本低**。
  - **MCMLE 计算成本过高，不适用于大规模网络**。

### **2. 计算优化建议**
- **使用 MPLE 进行快速参数估计**，再结合 MCMLE 提升精度。
- **对于大规模网络，使用子采样和多核计算优化 MPLE**。

---

## **总结**
本研究通过 **模拟实验** 对比了 **三种 ERGM 估计方法（CD、MPLE、MCMLE）** 在 **计数值网络** 中的表现，得出以下结论：
1. **MCMLE 适用于小规模、小方差网络**，提供最优估计质量，但计算成本较高。
2. **MPLE 适用于大规模、大方差网络**，计算时间快一个数量级，估计质量优于 MCMLE。
3. **CD 方法计算最快，但在大方差网络上表现不稳定，可能导致估计失败**。
4. **子采样和多核并行计算可有效优化 MPLE 计算效率**。

**最佳实践建议**：
- **小规模网络**：MCMLE 为最佳选择。
- **大规模网络**：MPLE 是最佳选择，结合子采样和多核计算优化计算成本。

本研究为 **社交网络分析中的 ERGM 估计** 提供了新的见解，尤其是在 **计数值网络的高效建模** 方面，为未来的研究和应用提供了重要的理论支持。

 [求同存异：多个网络指数随机图模型估计方法的比较.pdf](/Users/ww/Desktop/组会/组会（找文章）/ermg模型/求同存异：多个网络指数随机图模型估计方法的比较.pdf) 

## ***求同存异：多个网络指数随机图模型估计方法的比较***

## **研究背景与问题**
### **背景**
- **指数族随机图模型（ERGMs）** 是社会科学中用于分析社交网络的重要工具，能够同时建模网络的内生结构特征（如互惠性、传递性）以及外生变量（如性别、年龄、社会经济地位）。
- 传统 ERGM 主要用于 **单一网络** 的描述性分析，然而，许多社会科学研究涉及 **多个网络的分析**（例如不同学校的社交网络、不同国家的政治讨论网络）。
- **如何有效地估计多个网络的 ERGM** 仍然是一个未解决的问题，当前主要有两种方法：
  1. **分层方法（Hierarchical Approach）**：独立估计每个网络的 ERGM 参数，并在更高层次上聚合。
  2. **整合方法（Integrated Approach）**：将多个网络视为一个整体，并施加结构性约束来模拟不同网络之间的独立性。

### **核心问题**
1. **哪种方法在多个网络的 ERGM 估计中更准确？**
2. **如何在多个网络之间找到平衡，既考虑个体网络特征，又能得出更具普遍性的结论？**
3. **两种方法在计算效率、稳健性、适用性上的比较如何？**
4. **不同的层级结构（如国家、学校、班级）如何影响 ERGM 的估计？**

---

## **研究方法**
### **数据**
- **数据来源**：2021 年收集的国际社会网络研究数据，包括 **德国、意大利和葡萄牙** 的 **121 个学校班级网络**，分布在 **15 所学校**。
- **网络规模**：
  - **平均节点数**：19.92（标准差 6.77）
  - **平均入度**：2.31（标准差 0.53）
- **社交关系测量**：学生被要求提名 **最多 3 名朋友**，并收集 **性别、年龄、社会经济地位等人口统计数据**。

### **方法**
1. **指数族随机图模型（ERGMs）**
   - 设定 ERGM 统计量，包括：
     - **密度（Density）**
     - **互惠性（Reciprocity）**
     - **几何加权边共享伙伴（Gwesp）**
     - **几何加权入度（Gwidegree）**
   - 采用 **Bayesian Hierarchical Modeling** 进行分层估计。

2. **对比两种 ERGM 估计方法**：
   - **分层方法（Hierarchical Approach）**
     - 先独立估计每个网络的 ERGM 参数。
     - 采用 **Bayesian Hierarchical Models** 进行后续分析。
   - **整合方法（Integrated Approach）**
     - 使用 **mlergm R 包** 直接对所有网络进行联合估计。
     - 施加结构性零（Structural Zeros），确保不同网络中的节点无法相互联系。

3. **Monte-Carlo 模拟实验**
   - 设计多种网络结构，检验不同估计方法的适用性和误差水平。
   - **控制变量**：
     - **网络数量（K = 1, 3, 5）**
     - **群体大小（S = 10, 20, 30）**
     - **网络节点数（N = 20, 30, 40）**
     - **群体效应大小（δ = 0.1, 0.3, 0.6）**
   - **比较误差（Mean Absolute Error, MAE）** 以评估估计方法的准确性。

---

## **数学模型**
### **ERGMs 公式**
ERGM 的概率分布如下：

$$
P(Y = y | \theta, X) =
\frac{h(y) \exp(\theta^T g(y, X))}{\sum_{y' \in Y} h(y') \exp(\theta^T g(y', X))}
$$

其中：
- $Y$ 代表社交网络的关系矩阵。
- $g(y, X)$ 是网络的统计特征，如 **互惠性、传递性**。
- $\theta$ 是待估计的参数，衡量各网络特征对关系形成的影响。
- $h(y)$ 是基准测度，通常采用 **泊松分布（Poisson）** 控制边值分布。

### **分层贝叶斯模型**
基本的 **Bayesian Hierarchical Model** 公式如下：

$$
\hat{\theta}_k \sim Normal(\theta_k, \sigma_k^2)
$$

$$
\theta_k \sim Normal(\mu, \tau_k)
$$

$$
\mu \sim Normal(0, 1), \quad \tau_k \sim HalfCauchy(0, 1)
$$

- 其中$\hat{\theta}_k$是第$k $个网络的估计参数，$\theta_k $是真实参数，$\sigma_k^2$是估计误差。
- **当数据具有层次结构**（如国家、学校），可以引入更复杂的层级关系：

$$
\theta_k \sim Normal(\alpha_{country}, \tau_k)
$$

$$
\alpha_{country} \sim Normal(\alpha_{school}, \tau_{country})
$$

$$
\alpha_{school} \sim Normal(0, \tau_{school})
$$

---

## **研究结果**
### **1. 分层 vs. 整合方法**
- **分层方法的估计结果更稳定**，能够捕捉网络间的异质性，置信区间（CI）较宽。
- **整合方法的估计值偏差较大**，CI 较窄，可能存在**过度拟合**的问题。
- **当网络数量增加时，整合方法的误差显著上升**，说明该方法不适用于**多个不同来源的网络**。

### **2. Monte-Carlo 模拟**
- **分层方法误差最低**，且随着**网络数量增加，误差变化较小**。
- **整合方法在单一网络情况下表现良好**，但当**网络来源不同**时误差急剧上升。
- **网络规模越大，分层方法的准确性越高**。

---

## **政策与实践建议**
### **1. 选择合适的 ERGM 估计方法**
- **若网络来自不同来源**（如不同国家、学校），**分层方法更优**。
- **若所有网络具有相似的数据生成过程**，整合方法可能更有效。

### **2. 计算优化建议**
- **采用多核计算优化分层估计**，减少计算时间。
- **使用先验信息约束 ERGM 模型**，提高参数估计稳定性。

---

## **总结**
本研究对比了 **分层 ERGM 估计方法** 和 **整合 ERGM 估计方法**，发现：
1. **分层方法适用于多个来源的网络**，整合方法更适用于**单一来源的网络**。
2. **分层方法具有更低的估计误差和更好的稳健性**，但计算成本较高。
3. **整合方法计算成本低，但当网络异质性较强时误差显著增加**。

**最佳实践建议**：
- **多网络分析推荐使用分层方法**。
- **当计算资源有限且网络来源相似时，可使用整合方法**。

本研究为 **多网络 ERGM 估计** 提供了实证依据，促进更精确的社会网络分析。

 [临界随机图上具有重尾度分布的疫情传播.pdf](/Users/ww/Desktop/组会/组会（找文章）/ermg模型/临界随机图上具有重尾度分布的疫情传播.pdf) 

## **临界随机图上具有重尾度分布的疫情传播**

## **研究背景与问题**
### **背景**
- 传染病在社交网络上的传播是一个重要的研究问题，通常使用 **易感-感染-康复（SIR）模型** 进行建模。
- **随机图模型** 在研究大规模疫情传播时尤为重要，特别是当网络具有 **重尾（heavy-tailed）度分布** 时，疫情的传播模式可能会受到超传播者（super-spreaders）的影响。
- 经典 **Erdős-Rényi 随机图** 研究了普通网络中的疫情传播，但**重尾度分布网络中的疫情传播仍缺乏系统研究**。

### **核心问题**
1. **在具有重尾度分布的随机图上，SIR 传播模型的扩展特性是什么？**
2. **如何在这些网络上建立疫情传播过程的数学模型？**
3. **网络的结构（如超传播者的存在）如何影响疫情的规模和持续时间？**
4. **疫情传播过程中是否存在可预测的临界行为？**

---

## **研究方法**
### **随机图模型**
1. **配置模型（Configuration Model）**
   - 该模型允许控制网络的度分布，从而研究不同拓扑结构对疫情传播的影响。
   - 研究关注 **重尾度分布**（power-law distribution），其形式为：
     $$
     P(D \geq k) \sim k^{-\alpha}
     $$
     其中$ \alpha \in (1,2) $ 控制网络的重尾性。

2. **Erdős-Rényi 随机图**
   - 经典的 $ G(n, p) $ 随机图 被用于对比实验。
   - 其度分布接近泊松分布，缺乏超传播者。

### **疫情传播建模**
- 采用 **SIR 传播模型**：
  - **S（易感者）**：尚未感染但有可能被感染的人。
  - **I（感染者）**：已感染并具有传播能力的人。
  - **R（康复者）**：已感染并恢复，不再具有传播能力。

- **传播过程**：
  1. **初始状态**：随机选择一个感染者作为疫情的起点。
  2. **传播规则**：
     - 每个感染者每天**随机接触**一定数量的邻居，并以概率 $ p $ 传播病毒。
     - 传播后，感染者进入康复状态。
  3. **疫情终止**：当所有感染者都康复时，疫情停止传播。

### **数学建模**
1. **关键统计量**
   
   - 研究传染病传播时的**高度剖面（Height Profile）**：
     - 设 $ Z_n(h)$表示**在第 $h$ 天感染的人数**，那么整个疫情的传播过程可以看作是一个 **随机过程**：
       $$
       Z_n(h) = \text{感染者的数量（天数 \( h \)）}
       $$
   - **目标**：研究**极限情况下（$ n \to \infty $）** 的疫情传播模式。
   
2. **指数族随机图模型（ERGM）**
   
   - 用于分析疫情在**大规模网络中的传播特征**：
     $$
     P(Y = y) = \frac{\exp(\theta^T g(y))}{c(\theta)}
     $$
     其中：
     - $ Y $ 是感染传播的随机过程。
     - $ g(y) $是网络统计特征，如 **超传播性、传递性（transitivity）** 等。
     - $\theta $ 代表各变量对疫情传播的影响。

---

## **研究结果**
### **1. 关键疫情传播特性**
- 在**具有重尾度分布的网络**中：
  - **超传播者（super-spreaders）** 对疫情规模有显著影响。
  - 具有**大度值**的节点更可能成为疫情传播的关键枢纽。
  - 传播过程中出现了**不连续跃迁**（jumping process），即短时间内大规模感染事件。

- **比较不同网络**
  - 在 **Erdős-Rényi 随机图** 上，疫情扩散较均匀，传播规模受限于局部连接结构。
  - 在 **重尾度分布网络** 上，传播更容易爆发，疫情规模更大，**但更依赖少数高度连接节点**。

### **2. 规模极限分析**
- 当 $n \to \infty$ 时：
  - **疫情规模满足稳定分布**：
    $$
    Z_n(h) \to \text{α-稳定过程}
    $$
  - 这种极限分布显示了疫情传播的 **非连续增长**，与传统泊松模型不同。

- **临界现象**
  - 当传播概率 $p$ 超过某个阈值 $p_c$时，疫情规模 **突然增大**，表现出 **临界相变（phase transition）**。
  - 该行为可通过$ α$-稳定 Lévy 过程进行建模。

---

## **政策与实践建议**
### **1. 针对超传播者的防控措施**
- **在重尾度网络中，少数高连接节点承担大部分传播责任**，因此：
  - **优先接种疫苗**：为高风险超传播者优先提供疫苗或隔离措施。
  - **限制社交活动**：减少超传播者的接触机会可有效降低疫情规模。

### **2. 调整隔离策略**
- 研究表明 **重尾度网络上的疫情更易爆发**，因此：
  - **Erdős-Rényi 网络** 可采用 **均匀隔离策略**。
  - **重尾度分布网络** 需要 **针对高度数节点的定向隔离策略**。

### **3. 预测疫情规模**
- 由于**疫情传播受网络结构的强烈影响**，政府可以：
  - **利用网络分析技术** 识别**关键传播枢纽**。
  - **提前预测疫情扩散趋势**，并制定针对性政策。

---

## **总结**
本研究探讨了 **SIR 传播模型在重尾度分布随机图上的行为**，发现：
1. **超传播者对疫情传播具有关键作用**。
2. **相比于 Erdős-Rényi 随机图，重尾度网络上的疫情传播更容易形成大规模爆发**。
3. **疫情传播呈现 $α$-稳定过程，表现出非连续增长和临界相变特性**。

**政策建议**：
- 重点关注超传播者，制定 **定向防控措施**。
- 在不同网络结构中 **采用不同的隔离策略**。
- **利用社交网络分析技术预测疫情爆发风险**。

本研究为 **流行病学、网络科学和公共政策** 提供了新的理论基础，有助于 **制定更精准的疫情防控措施**。

# 关于Latent Order Logistic 在其他社会学或经济学角度的应用

 [Bayesian Hui-Walter 与 Logistic 回归潜类模型在诊断测试特性估计中的比较研究.pdf](/Users/ww/Desktop/组会/组会（找文章）/lolog模型/Bayesian Hui-Walter 与 Logistic 回归潜类模型在诊断测试特性估计中的比较研究.pdf) 

## ***Bayesian Hui-Walter 与 Logistic 回归潜类模型在诊断测试特性估计中的比较研究***

## **研究背景与问题**
### **背景**
- 在流行病学中，**诊断测试的准确性评估** 是一项核心研究任务，但许多疾病缺乏完美的“金标准”测试。
- **Hui-Walter（HW）潜类模型** 是过去几十年最常用的方法之一，能够在没有金标准的情况下估计测试的灵敏度（Sensitivity, Se）和特异性（Specificity, Sp）。
- 然而，传统的 HW 模型主要在**群体层面聚合测试数据**，**无法充分利用个体层面的信息**（如个体风险因素、群体内聚类效应）。
- **Logistic 回归（LR）潜类模型** 允许引入**个体层面协变量**，提供更精确的测试特性估计。
- 本研究使用**模拟数据**，比较 **Bayesian HW 和 LR 潜类模型** 在估计诊断测试灵敏度和特异性方面的性能。

### **核心问题**
1. **HW 与 LR 潜类模型在不同群体特征下的测试特性估计表现如何？**
2. **个体层面数据（如风险因素）对模型估计能力的影响是什么？**
3. **群体内部聚类效应（herd-level clustering）如何影响测试特性估计？**
4. **不同地区的疾病流行率如何影响两种方法的估计精度？**

---

## **研究方法**
### **数据模拟**
- **数据来源**：基于牛**副结核病（paratuberculosis）** 流行率和测试特性模拟数据。
- **研究对象**：
  - **两个地区（Region 1 和 Region 2）**
  - **每个地区 20 个等规模的牧群（Herds），共 4000 头牛**
- **疾病流行率**：
  - **Region 1：10%**
  - **Region 2：30%**
- **两种二分类诊断测试**：
  - **测试 1**：灵敏度 70%，特异性 99%
  - **测试 2**：灵敏度 75%，特异性 95%
- **个体层面风险因素**：
  - **采用 Bernoulli 分布生成，成功概率 0.30**
  - **真实风险比（Odds Ratio, OR）设定为 1.5**
- **群体内部聚类效应（Herd-level Clustering）**：
  - 设定**中等聚类效应**，组内相关系数（ICC）为 0.20。

---

## **建模方法**
### **1. Hui-Walter 潜类模型**
- **基于个体测试结果的交叉表（Crosstabulation）** 进行计算。
- **假设**：
  - **条件独立性**：在给定真实疾病状态的情况下，两个测试的结果相互独立。
  - **测试特性恒定**：测试的灵敏度和特异性在不同群体间不变。
- **估计参数**：
  - **灵敏度（Se1, Se2）**
  - **特异性（Sp1, Sp2）**
  - **群体疾病流行率（p1, p2）**
- **模型输入**：两个测试的 2 × 2 矩阵。

### **2. Logistic 回归潜类模型**
- **引入个体层面协变量**（风险因素、群体效应）。

- **随机效应（Random Effects）**：
  - **地区效应（Region-level）**
  - **牧群效应（Herd-level）**
  
- **回归模型**：
  $$
  \text{logit}(p_{ihr}) = \beta_0 + \beta_1 RFihr + u_r + u_h
  $$
  其中：
  - $p_{ihr}$为个体 $i $ 在牧群 $h$ 和地区 $ r$ 的真实疾病概率。
  - $RFihr$为个体层面的二分类风险因素。
  - $u_r \sim N(0, \sigma^2_r) $ 代表地区效应。
  - $u_h \sim N(0, \sigma^2_h)$ 代表牧群效应。

### **3. 贝叶斯推断**
- **参数估计方法**：
  - **非信息性 Beta 先验分布（Beta(1,1)）** → 适用于灵敏度、特异性、疾病流行率参数。
  - **正态先验分布（N(0, 1000)）** → 适用于 Logistic 回归的回归系数。
  - **逆伽马分布（Inverse-Gamma(0.001, 0.001)）** → 适用于随机效应的方差参数。
- **使用 MCMC 进行贝叶斯推断**：
  - **JAGS + R runjags 包**
  - **每个模型运行 4 条 Markov 链**
  - **5000 次 burn-in + 10,000 次采样**

---

## **研究结果**
### **1. HW 与 LR 在测试特性估计上的比较**
- **Logistic 回归潜类模型（LR）比 Hui-Walter（HW）提供更精确的估计**。
- **HW 方法的置信区间更宽，特别是当数据层级增加时**。
- **考虑群体内部聚类效应的 LR 模型（LR_h, LR_RF_h）提供最稳定的估计**。

### **2. 影响因素分析**
- **个体风险因素的影响**：
  - 当 OR = 2.7 或 7.4 时，基于 HW 方法的估计明显改善。
  - **LR 方法在较低 OR 情况下仍然保持稳定**。
- **群体内部聚类效应（Herd Clustering）**：
  - ICC = 0.10 时，**估计偏差增大**，LR 仍然比 HW 更稳定。
  - ICC = 0.30 时，**估计精度略有提升**，但 HW 方法的置信区间仍然较宽。
- **地区疾病流行率的影响**：
  - 当疾病流行率较低（5%，25%）时，**测试灵敏度的估计精度下降**。
  - 当疾病流行率

 [一种新的图生成统计模型：潜在顺序逻辑（LOLOG）模型.pdf](/Users/ww/Desktop/组会/组会（找文章）/lolog模型/一种新的图生成统计模型：潜在顺序逻辑（LOLOG）模型.pdf) 

## ***一种新的图生成统计模型：潜在顺序逻辑（LOLOG）模型***

## **研究背景与问题**
### **背景**
- 统计模型在复杂网络的建模中至关重要，但目前通用、灵活且适用性广泛的生成模型仍较少。
- **指数族随机图模型（ERGM）** 是社会科学中最受欢迎的生成模型之一，但它在可扩展性和模型退化（degeneracy）方面存在局限。
- **许多现有的网络生成模型**（如 Barabási-Albert 优先连接模型）只能描述特定网络特征，缺乏完整的概率建模框架。

### **核心问题**
1. **如何构建一个能够描述任意概率分布的网络生成模型？**
2. **如何通过数据推断模型参数，使其具有实际可估计性？**
3. **该模型如何与现有的 ERGM 进行对比，在哪些方面表现更优？**
4. **如何应用该模型分析现实中的社交网络，如公司内部协作网络和青少年友谊网络？**

---

## **研究方法**
### **Latent Order Logistic（LOLOG）模型**
LOLOG 是一种基于 **网络增长（network growth）** 原理的新型概率模型，核心思想如下：
1. **网络随时间增长**，即边的形成是一个逐步累积的过程。
2. **边的添加顺序是随机变量**，这一特性允许模型表达更一般的网络结构。
3. **模型采用 Logistic 回归结构**，使用图统计量的变化作为预测变量：
   $$
   P(Y_{st} | \theta, Y_{t-1}, S_{\leq t}) = \frac{1}{Z_t} e^{\theta \cdot c(Y_{st} | Y_{t-1}, S_{\leq t})}
   $$
   其中：
   - $Y_{st} $ 是第 $t $ 个被考虑的边。
   - $c(Y_{st} | Y_{t-1}, S_{\leq t}) $ 代表该边加入后对图统计量的影响。
   - $Z_t$ 是归一化常数。

4. **LOLOG 可以避免 ERGM 退化问题**，同时便于进行独立抽样，提高计算效率。

### **ERGM 与 LOLOG 的对比**
- ERGM 主要基于**静态平衡网络**，即所有边的形成遵循某种**全局分布**。
- LOLOG 采用**动态增长视角**，可以更自然地建模现实网络的生成过程。
- 两者在**二元独立（dyadic independence）情况下是等价的**，但 LOLOG 在处理网络增长、避免退化和提高计算效率方面具有优势。

---

## **数学建模**
### **LOLOG 公式**
- **一般形式**：
  $$
  P(Y | S, \theta) = \prod_{t=1}^{nd} \frac{1}{Z_t} e^{\theta \cdot c(Y_{st} | Y_{t-1}, S_{\leq t})}
  $$
  其中：
  - $S $ 是边形成的顺序。
  - $\theta$ 是模型参数。

- **极限形式**（边形成顺序未知时）：
  $$
  P(Y | \theta) = \sum_{S} P(Y | S, \theta) P(S)
  $$
  由于该式的求和维度极高，通常采用**蒙特卡罗方法**进行近似推断。

### **推断方法**
1. **蒙特卡罗矩估计（MOM）**：
   - 通过模拟网络样本计算网络统计量的期望，调整参数使其与观察值匹配。
   - 适用于**边的形成顺序未知**的情况。

2. **广义矩估计（GMM）**：
   - 通过**最小二乘优化**匹配观察网络统计量与理论值。
   - 适用于**包含顺序依赖的统计量**。

3. **变分推断（Variational Inference）**：
   - 通过优化下界估计 $P(Y | \theta)$。
   - 计算效率较高，适用于**大规模网络**。

---

## **研究结果**
### **1. ERGM vs. LOLOG**
- **LOLOG 具有更好的计算效率**，避免了 ERGM 中的马尔科夫链蒙特卡罗（MCMC）收敛问题。
- **LOLOG 能够表达 ERGM 退化问题难以拟合的网络特征**，如两星结构（two-star）和三角关系（triangle count）。
- **在边的形成顺序已知的情况下，LOLOG 更加直观，能直接使用 Logistic 回归方法进行推断**。

### **2. 现实网络应用**
1. **公司律师事务所的协作网络**
   - **数据**：某律师事务所的 36 名合伙人的合作关系。
   - **模型拟合结果**：
     - **办公室、业务领域、性别匹配** 均显著影响合作关系。
     - **LOLOG 模型优于 ERGM**，能更稳定地估计**三角关系的影响**。

2. **青少年友谊网络（Add Health 数据集）**
   - **数据**：1270 名美国高中生的友谊关系。
   - **主要影响因素**：
     - 年级（Grade）、性别（Gender）、饮酒行为（Drinking）
     - 社交传递性（Transitivity）
   - **LOLOG 模型显示**：
     - **同年级和同性别友谊概率显著更高**。
     - **传递性作用显著**（朋友的朋友更可能成为朋友）。
     - **相比 ERGM，LOLOG 能够更稳定地处理两星和三角关系**。

3. **Hamsterster 社交网络**
   - **数据**：1856 只仓鼠的在线友谊关系（Hamsterster.com）。
   - **主要影响因素**：
     - 仓鼠的**颜色、种类、地理位置、喜欢的玩具和食物**。
   - **结果**：
     - **仓鼠更倾向于与相同物种、颜色或相同地理位置的仓鼠成为朋友**。
     - **偏好连接（preferential attachment）和共享邻居（shared neighbors）作用显著**。

---

## **政策与实践建议**
### **1. 选择合适的网络建模方法**
- 若研究**静态网络**，ERGM 仍然适用。
- 若研究**动态网络或网络增长过程**，LOLOG 更具优势。

### **2. 计算优化**
- LOLOG 可避免 ERGM 的退化问题，提高计算效率。
- **推荐使用变分推断（VI）** 进行大规模网络分析。

### **3. 复杂网络应用**
- 可应用于**社交网络、经济网络、生物网络**，特别是当**网络增长模式较重要**时。

---

## **总结**
- **LOLOG 是一种基于网络增长的新型概率模型**，能够描述任意图分布，并避免 ERGM 的退化问题。
- **LOLOG 的计算效率更高，适用于大规模网络建模**。
- **实验表明，LOLOG 在现实网络分析中优于 ERGM**，特别是在**三角关系、两星结构和社交传递性建模方面**。

**结论**：LOLOG 提供了一种更灵活、更稳定的网络建模框架，为社会网络分析、经济网络建模和复杂系统研究提供了新的工具。